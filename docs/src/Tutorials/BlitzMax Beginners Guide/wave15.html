<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Page 15</title>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<link href="wave.css" type=text/css rel=stylesheet>
</head>
<body bgcolor="#FFFFFF">
<table border="0" width="700" align="center" cellspacing="0">
<tr>
  <td class="copy">Wave's~ BlitzMax Tutorial for NG</td><td align="right" class="copy">~ November, 2015 ~ Version 11</td></tr>
<tr><td class="cap2">Beginners guide to BlitzMax</td><td align="right" class="cap2">&nbsp;</td></tr>
<tr><td colspan="2"><hr></td></tr>
<tr><td class="cap" colspan="2">Abstract and Final</td></tr>
<tr><td class="idx2" colspan="2">
If you have an Abstract Type you'll be unable to create a new instance of that type. Which means it will be almost useless, or will it? You can still have functions and Globals and Fields in it. But you'll never be able to access those fields, except if you extend that type. The reason for abstract types is so that the user (which is a programmer using your type, including you) won't by mistake create a new instance of it. Vehicle is a good example. You cannot create a new Vehicle. Why you say. Because how would I draw a vehicle? As a car, a truck or a helicopter? Vehicle is abstract. This does not stop me from creating a car or a truck or anything extending Vehicle. The only thing you can't create an instance of is the abstract Type itself, Vehicle. But isn't car a Vehicle? Yes it is, but Car is not abstract so therefore you can both Draw and Create cars which are vehicles =)<br>&nbsp;<br>
Let's say I want all Vehicles to have a method called create, so that all vehicles I use will be creatable (like a common interface for all vehicle objects). In this case I can make an abstract method, which will do nothing except giving a compile error if someone tries to make an extended vehicle (like Car or Bus) without a method called create. Finally instead of abstract disallows users to extend a type, let's say I don't want people extending my Car, if they try too they'll receive a compile error telling them they can't because it's final. You can also set methods as final which will disallow people from overriding them.</td></tr> 
<tr><td class="cap" colspan="2"><br>LinkedLists ­ Lists of Objects</td></tr>
<tr><td class="idx2" colspan="2">
The default list in B-max is called TList . To help you better understand lists and for you to use them well I'll try to explain how they work. When you first create a new list it comes empty. Next you may add an object to it. (For this example Ship). The Ship is now the first and last object in the list. If we add another object we have a choice, to either add it to the beginning or end of the list. For each object you add to the list you add a link to the list.<br>&nbsp;<br>
The Link contains three fields:<br>
1) The Object you added to the List<br>
2) A Link to the Next Link<br>
3) A Link to the Previous Link.<br>&nbsp;<br>
In this way it is possible to loop thru the list because each link is connected to another link. Like a long chain. The number of links depends on the number of objects. You never need to use the Link by yourself, BlitzMax does that for you with methods and functions like AddLast( Object ) or RemoveLast().<br>&nbsp;</td></tr>
<tr><td class="idx2" colspan="2"> 
Put this code in a new file and test it, I'm going to extend it later.</td></tr>
<tr><td class="code" colspan="2"><span class="cy">Type</span><span class="cw"> TShip</span><br>
<span class="cy">&nbsp;Field</span><span class="cw"> Name$,Score</span><br>
<span class="cy">End Type</span><br>
&nbsp;<br>
 
<span class="clb">'Create some Ships</span><br>
<span class="clb">'__________________________</span><br> 
<span class="cy">Global</span><span class="cw"> Ship:TShip</span><br> 
<span class="cw">Ship =</span><span class="cy"> New</span><span class="cw"> TShip</span><br>
<span class="cw">Ship.Name =</span><span class="cg"> "My First Ship"</span><br>
<span class="cw">Ship.Score =</span><span class="cb"> 11</span><br>&nbsp;<br>
 
<span class="cy">Global</span><span class="cw"> Ship2:TShip</span><br>
<span class="cw">Ship2 =</span><span class="cy"> New</span><span class="cw"> TShip</span><br>
<span class="cw">Ship2.Name =</span><span class="cg"> "My 2nd Ship  "</span><br>
<span class="cw">Ship2.Score =</span><span class="cb"> 3</span><br>&nbsp;<br>
 
<span class="cy">Global</span><span class="cw"> Ship3:TShip</span><br>
<span class="cw">Ship3 =</span><span class="cy"> New</span><span class="cw"> TShip</span><br>
<span class="cw">Ship3.Name =</span><span class="cg"> "The 3rd Ship "</span><br>
<span class="cw">Ship3.Score =</span><span class="cb"> 9</span><br>
<span class="clb">'___________________________</span><br>&nbsp;<br>
 
<span class="cy">Global</span><span class="cw"> MyList:</span><span class="cy">TList</span><span class="clb"> 'Define the List</span><br>
<span class="cw">MyList =</span><span class="cy"> CreateList</span><span class="cw">()</span><span class="clb"> 'Create a New List</span><br> 
<span class="cw">MyList.AddFirst(Ship)</span><span class="clb">  'Add Object to List</span><br> 
<span class="clb">'Now you could add to the top of the list</span><br>
<span class="clb">'MyList.AddFirst()</span><br>
<span class="clb">'Or add to the bottom</span><br> 
<span class="cw">MyList.AddLast(Ship2)</span><br>
<span class="cw">MyList.AddLast(Ship3)</span><br> 
<span class="cy">For Local</span><span class="cw"> S:TShip =</span><span class="cy"> EachIn</span><span class="cw"> MyList</span><br> 
<span class="cy">&nbsp;Print</span><span class="cg"> "Name: "</span><span class="cw">+S.Name+</span><span class="cg">" Score:"</span><span class="cw">+S.Score</span><br>
<span class="cy">Next</span><br>
<span class="clb">'How many objects in the List?</span><br>
<span class="cy">Print</span><span class="cg"> "Links/Objects in the List: "</span><span class="cw">+MyList.Count()</span>
</td></tr>
<tr><td class="idx2" colspan="2"><br> 
So far there is nothing new, this was just the basics. We have encountered a problem that came from the use of lists. If your program has a place where it loops through a list that does not exist, you'll receive a runtime error. The solution is simply to put an if statement around your For.. Eachin Loop.  You could also make sure you create the list before the loop (no matter what). Make sure you don't skip CreateList() or New Tlist.<br>&nbsp;<br> 
If you on the other hand have a list you want to clear you can remove all objects from the list using MyList.Clear(). That will clear the list but not delete it.<br>&nbsp;<br> 
An object exists as long as any variable is pointing to it. In the previous example the first-ship had two links. First the Global variable Ship:TShip and second the Link in the List. So to delete this ship you first have to erase the global: Ship = null. Second you have to delete the first ship in the list. (This is easy because it is at the top of the list). Simply go MyList.RemoveFirst(). If you do that there will be no way to retrieve the Name$ and the Score of this ship, therefore it will get deleted by BMax at the next Flushmem (you should have Flushmem once in your mainloop).<br>&nbsp;<br> 
MyList is of the TList-Type (or a TList-Object). RemoveFirst(), Clear() and most other commands are methods in TList. I guess you already knew that, but just to be sure.<br>&nbsp;<br>  
A TList can contain any object, just like an array of objects. Arrays and Lists share many characteristics.</td></tr>
 <tr><td class="idx2" colspan="2"><br>
Add these lines to the previous example, just below MyList.AddLast(Ship3)</td></tr>
<tr><td class="code" colspan="2"> 
<span class="cw">MyList.AddFirst(</span><span class="cg">"A String is also an object"</span><span class="cw">)</span><br> 
<span class="cw">MyList.AddLast(</span><span class="cg">"This is now the last object"</span><span class="cw">)</span>
</td></tr>
<tr><td class="idx2" colspan="2"><br> 
If you run the program you'll see only the Ships being displayed. But the number of Objects in the list is five!</td></tr>
<tr><td class="idx2" colspan="2"><br>Add this:</td></tr>
<tr><td class="code" colspan="2"> 
<span class="cy">For Local</span><span class="cw"> Str$ =</span><span class="cy"> EachIn</span><span class="cw"> MyList</span><br>
<span class="cy">&nbsp;&nbsp;Print</span><span class="cg"> "String: "</span><span class="cw">+Str</span><br>
<span class="cy">Next</span></td></tr>
<tr><td class="idx2" colspan="2"> 
The Eachin-Loop only loops through the objects of the specified type found in the list. First I looped each Ship in MyList, now I Loop Each String in MyList.<br>&nbsp;<br>  
The actual List looks something like this now:<br>
"A String is also an Object" - Ship - Ship2 - Ship3 - "This is now the last Object"<br>
Let's say I want to print the Strings and the names of the Ships in the correct order, how to do that?<br>&nbsp;<br>

It's quite simple yet a little more complicated than before. What you do is loop all Objects in MyList.<br>&nbsp;<br>
Like this:</td></tr>
<tr><td class="code" colspan="2"> 
<span class="cy">For Local</span><span class="cw"> TempObject:</span><span class="cy">Object</span><span class="cw"> =</span><span class="cy"> EachIn</span><span class="cw"> MyList</span><br>
<span class="cy">&nbsp;&nbsp;Print</span><span class="cw"> TempObject</span><br>
<span class="cy">Next</span></td></tr>
<tr><td class="idx2" colspan="2"> 
The above code does not work! It shouldn't.<br>&nbsp;<br>
It may be obvious that we can't print a Ship, but the String? No neither of them will print straight off (Casting again). You first have to tell Bmax you want to convert the tempObject to a string or a ship and then print them in turn.<br>&nbsp;<br>
Replace both of the each-in loops with this loop.</td></tr>
<tr><td class="code" colspan="2"> 
<span class="cy">For Local</span><span class="cw"> TempObject:</span><span class="cy">Object</span><span class="cw"> =</span><span class="cy"> EachIn</span><span class="cw"> MyList</span><br>
<span class="cy">&nbsp;&nbsp;Local</span><span class="cw"> TempShip:TShip = TShip(TempObject)</span><br>
<span class="cy">&nbsp;&nbsp;Local</span><span class="cw"> TempString$ =</span><span class="cy"> String</span><span class="cw">(TempObject)</span><br>
<span class="cy">&nbsp;&nbsp;If</span><span class="cw"> TempShip</span><span class="cy"> Print</span><span class="cg"> "This Object is a Ship it's Name is: "</span><span class="cw">+TempShip.Name</span><br>
<span class="cy">&nbsp;&nbsp;If</span><span class="cw"> TempString</span><span class="cy"> Print</span><span class="cg"> "String Object :"</span><span class="cw">+TempString</span><br>
<span class="cy">&nbsp;&nbsp;If Not</span><span class="cw"> TempShip</span><span class="cy"> And Not</span><span class="cw"> TempString</span><span class="cy"> Print</span><span class="cg"> "Unknown Object in List"</span><br> 
<span class="cy">Next</span></td></tr>
<tr><td class="idx2" colspan="2">
If you would have added another object to the loop it would not print. Above I used casting to see the objects true type. See casting for more information.</td></tr>
<tr><td class="code" colspan="2"> 
<span class="cy">Strict</span><br>
<span class="cy">Global</span><span class="cw"> MyList:</span><span class="cy">TList</span><br>
<span class="cw">MyList =</span><span class="cy"> CreateList</span><span class="cw">()</span><br>&nbsp;<br> 
<span class="cw">MyList.AddLast(</span><span class="cg">"Car"</span><span class="cw">)</span><br>
<span class="cw">MyList.AddLast(</span><span class="cg">"Bus"</span><span class="cw">)</span><br>
<span class="cw">MyList.AddLast(</span><span class="cg">"Airplane"</span><span class="cw">)</span><br>
<span class="cw">MyList.AddLast(</span><span class="cg">"Boat"</span><span class="cw">)</span><br>
<span class="cw">MyList.AddLast(</span><span class="cg">"Train"</span><span class="cw">)</span><br>
<span class="cw">MyList.AddLast(</span><span class="cg">"UFO"</span><span class="cw">)</span><br>&nbsp;<br> 
<span class="cy">Print </span><span class="cg">"--LIST--"</span><br>
<span class="cy">For Local</span><span class="cw"> Vehicle$ =</span><span class="cy"> EachIn</span><span class="cw"> MyList</span><br>
<span class="cy">&nbsp;&nbsp;Print</span><span class="cw"> Vehicle$</span><br> 
<span class="cy">Next</span><br>&nbsp;<br> 
<span class="clb">'Let's say we want to add a Tank after bus</span><br> 
<span class="cw">MyList.InsertAfterLink(</span><span class="cg">"Tank"</span><span class="cw"> , MyList.FindLink(</span><span class="cg">"Bus"</span><span class="cw">) )</span><br>
<span class="clb">'This would be the same as'MyList.InsertBeforeLink("Tank" , MyList.FindLink("Airplane") )</span><br> 
<span class="cy">Print</span><span class="cw"> "--LIST--With a Tank After Bus"</span><br>
<span class="cy">For Local</span><span class="cw"> Vehicle$ =</span><span class="cy"> EachIn</span><span class="cw"> MyList</span><br>
<span class="cy">&nbsp;&nbsp;Print</span><span class="cw"> Vehicle$</span><br>
<span class="cy">Next</span></td></tr>
<tr><td class="idx2" colspan="2"> 
InsertBeforeLink takes an Object and puts it before a Link. InsertBeforeLink( Object , TLink ). To get a TLink in our list we search the List for an Object "Bus". In this case it's a string so it's easy. If there are more strings with the same name it will take the first it encounters that match. The FindLink command checks the list for an object. So to use it you have to know the object. Like in our example you could use Ship,Ship2,Ship3 as reference to the object and FindLink would then retrieve that Link which you in turn can use with the other commands. You can also use the Method Contains MyList.Contains(Ship3) to check if that object exists in the list.

</td></tr>
<tr><td colspan="2">&nbsp;</td></tr>
<tr><td class="idx2"><a href="wave1.html">To Index</a> | <a href="wave16.html">Next Page</a></td>
	<td align="right" class="cap">page 15</td></tr>
</table>
</body>
</html>